

### 24.2 定態性
問序列分析需要利用事物特徵變數的歷史和現狀來推測其未來可能出現的狀況，能如此分析的前提是「歷史可以重演」，即時間序列的基本特徴必須能從過去維到我們欲推測的時期。否則，基於歷史和現狀來預浿怽來的想法便是沒有依

如果時間序列的基本特徴維持不變，我們就稱該時間序列是定態（stationary），相反的，若時間序列的基本特徴只存在於所發生的當期，並不會延續到未來、則這樣一個的時間序列不足以昭示未來，我們便稱這樣的本列是非定態的。定態丨生要求經由樣本時間序列所得到的曲線在未來的一段期問內仍能順著現有的形態「慣性」地延續下去。金融領域很多變數之所以難以佸計，就是因為這些變數經常突變，是非定態的。

時間序列定態是經典時間序列分析得以進行的基本假設；只有基於定態時間序列的預測才是有效的。如果我們要研究樣本時間序列是非定態的，我們通常會將它轉巪定態的時間序列，再進行研究。接下來，我們來介紹一下時間序列定態性的嚴格定義。定態性有嚴格定態和弱定態之分。由於嚴格定態的條件過於嚴格，所以一般情況下，我們所說的定態時間序列都是指弱定態時間序列。

#### 24.2.1 嚴格定態

設為一時間序列，對於任意正整數，任取/t.。/，，eT，對任意整數~有：

即x，，X，，…，Xt的聯合分佈（”…戗）與Xt+r，xt+：的聯合分佈）相同，那麼我們就稱時間序列是嚴格定態的（strongly十Stationary，Strictlystationary）。從定義上來看，嚴格定態是一個很強的條件，若一個時間序列滿足嚴格定態性，則該序列的任何統計性質不會隨時間改變。不過嚴格定態性的條件過於嚴苛，在理論上不易證明一個序列是嚴格定態，在實際上也很難檢定。

#### 24.2.2 弱定態

弱定態性（weaklystationary）依然要求時間序列的基本特徴維持不、其放寞定態的條件，將序列的基本特徴用幾個常見的、比較好衡量的統計量來代表，因此弜定態性ㄡ被稱廣義定態性（wide“"。。stationa「y）。弱定態性是將序列的基本特用序列的低階動差來代表，只要保證序列低階動差定態，就可以認為序列的主忹質近似穩定。假設是一個時間序列，如果滿足以下三個條件：

l. 任，丆，有，即序列的均值為常數；

2. 任取te丆，有E（xoK00，即存在=階動差；

3. 任取e丆，對任意整數h，任意階數/，有（t）=（/+h），即t時點/階自變異數尸，（t）與t+h時點/階自變異數（t+h）相等，換句話說、/階自變異數（t）的大小不隨t值變動，只與/的取值有關。

則稱（t）弱定態時間序列，也稱廣義定態或二階定態。第三個條件中，/=0時可以得到：弱定態時間序列的變異數不隨時間改變。弱定態性的三個條件與嚴格定態性相比，更具有實用性，因此通常我們談到時間序列的定態性時、一般都是指弱定態性。

#### 24.2.3 嚴格定態與弱定態的區別
嚴格定態與弱定態這兩種定態過程並沒有包含關係，即弱定態不一定是嚴格定態，嚴格定態也不一定是弱定態。

~方面，雖然嚴格定態的要求比弱定態更要嚴格一些，但嚴格定態並不一定是弱定態，因為嚴格定態的時間序列的動差不一定存在。例如，柯西分亻布不存在一、二階動差，所以服從柯西分佈的嚴格定態時間序列就不是弱定態時間序列

另~方面，弱定態不一定是嚴格定態，因為二階動差性質並無法確定分佈的性質。但是有一個特例：服從常態分佈的時間序列，由於常態分佈的均值（一階動差）和變異數（二階動差）決定了其整個分亻布，因此服從常態分佈的弱定態序列也是嚴格定態的。一般情況下，當序列的一階動差和二階動差存在時，嚴格定態序列一定是羽定態的。

### 24.3 加權股價指數的定態性檢定

時間序列的定態性是許多時間序列分析方法的前提，建構模型預測時間序列未來取值情況之前，需要檢定該時間序列的定態性。如何判斷一個時間序列的定態性，是我們接下來要探討的問題

#### 24.3.1 觀察時間序列圖

首先，透過觀察時間序列圖的形狀來大致辨別其定態性。

圖24.3：2014-2015年加權股價指數的收盤指數時序圖

我們可以依據時間序列定態性的特點，從時序圖的形態來大致判斷其定態性依據弱定態性的定義，序列的均值和變異數是一個常數。簡單地講，假定我們有固觀察資料，定態性意味著時序圖中的個值在一個常數水平上下以相同的幅度波動因此，如果資料的時序圖圍繞一個水平線上下以大致相同的幅度波動，那麼該蒔序列可能具備弱定態性。如果時序圖有著明顯遞増遞減趨勢或週期波動的態'那麼該時間序列很有可能是不定態的。

來分析加權股價指數的收盤指數的時序圖，圖00是加權股價指數的收盤指資的時序圖。我們可以看到00、、年、月到；月，收盤指數價格有明顯的向上趨勢；2014年8月到月，加權股價指數的收盤指數則呈現向下趨勢。2014年10月到2015年6月份左右，又呈現整體向上，接著向下運動，知道2015年9月份左右，又轉而向上。整體上看，該時序圖有明顯的上升趨勢，我們可以判斷其不是定態性時間序列。

再觀察2014.2015年加權股價指數的收益率時序圖（圖24.4），我們可以發現收益率大致圍繞在一個水平線上以相同的幅度上下波動，所以我們可以初步認為加權股價指數的收益率指數具有定態性

#### 24.3.2 觀察序列的自相關圖和偏自相關圖

觀自相關圖與偏自相關圖是判斷時間序列定態性、第=種方法。自、關係數、0偏

自相關係數或者偏自相關係數往往會快速減小至0附近或者在某一階段後變0
很多非定態時序列則沒有這樣的特徵，其自相關係數多數會呈現出緩僈下降旳
勢，而不是快速減小。


圖247：2014-2015年加權股價指數的收盤指數時序圖（）0期）

觀察加權股價指數的收益率指數ACF圖（圖24.5），可以看出指數收益率序列的
自相關係數很快減小為0，然後幾乎都在0附近上下運動同樣地，從鬪24.6我
們也可以看出，加權股價指數的收益率指數的偏自相關係數也一直在0附近。我
們推斷出加權股價指數的收益率指數序列具有定態性。而從圖24.7中我們可以看
到，收盤價指數的自相關係數較大，而且衰減的速度比較慢，進而推斷收盤指數序
列不具有定態性。

24.3.3單根檢定

觀察歭序圖、自相關圖和偏自相關圖來判斷時間序列的定態性時，不同的人對於
形的解讀可能不一樣，因而透過圖的形態推斷出時間序列定態性的結論就會有差
異。了使序列定態性的檢定更加客觀，我們將介紹一種統計檢定，稱為單根檢
定。

在介紹單根檢定之前，我們先來瞭解一下非定態時間序列的一些性質。如果序列是
非定態旳，經過d次差分（Di「。，、。。）可以將其轉換成定態序列，則稱此序列為
I（旳，其中1是指整合（Integ「ated），為整合階數。例如：
1
係數與0，殳有顯著性差異，即對其是否為0進行統計檢定得到的值大於：%。
X~+q
，ㄣ~Ⅳ（0）根據計算得到：
其中=0
-E（xj）*（xo+q
E（xt）-E（xt-l）-
2
2
Var（），）=Var（xt-l）+

因為x，的變異數會隨著時間/發生改變，因此該時間序列是非定態的。不過x，經
過一階差分後，，=q為定態的時間序列，因此為非定態的罒
序列

一個時間序列是否定態，可藉助落後運算元（LagOperator）多項式方程的根來
判斷，落後運算元是將一個時間序列的前一期值鱄化為當期值的運算元，通常用
刀來表示、例如對時間序列運用落後運算元可得，ㄥ
，刀x=x

接下來，我們來介紹一下為什麼可以藉助落後運算元多項式的根來判斷時間
裡依然沿用最簡單的例子，x，=一，其中=0
序列的定態性，
.=樣的序列又被稱為隨機漫步過程（Randomwalkprocess）。
q~Ⅳ（0，
，也就是說，離當前時間/很久之前的隨
我們可以把=xt-l+q改寫為=
機誤差（例如q）對現在的影響仍然沒有衰減。=+q還可以改寫為.
，可

其中1一ㄥ即為落後運算元多項式（序列特殊故這裡是單項式），专一
得單根ㄥ=1，因此t）也可以被稱為單根過程。總結起來，間序列Ⅱ”隨
機漫步渦程，其落後運算元多項式的根有單根，是個非定態的時間序列

上面的例子雖然可以輔助說明我們理解，但是過於特殊。我們再個例孒，例如、
非定態時間序列0滿足'
2讀者可根據弱定態性的定義目行對其撿定，即檢查均值、變異數、共變異數是否特不

~/0），式（2）可以改寫為：

可得落彶運算元多項式方程
1一（1+902）ㄥ+=0
1
>1

該方程的兩個根為=1和IP21
。的表示式可以改寫為：

從式子的前半部分來看，fyr）包含了隨機漫步的成分，換句話說，如果時間序列
具有單根，也就包含了隨機趨勢。一般來說，單根與隨機趨勢被視為相同的概念。

現在我們將情況一般化，假設時間序列滿足以下式子.
=∕+Ply，+P2一2+…+P叩+

藉助於落後運算元，可以將上面的模型改寫成：
十=1一P一P2ㄥ一

對應的落後運算元多項式方程為：
一p=0
1一p（刀）=1一p，ㄥ一p」ㄥ一

如果1一p（ㄥ）=0所有根的絕對值都大於1，那麼時間序列為定態的時間序
列。如果1一p（ㄥ）=0存在單根，那麼時間序列），，就是非定態，對該時間序列的
未來值的預測就難以進行

常見的單根檢定的方法有DF檢定（Dickey-FullerTest）、ADF檢定（Augmented
Dickey-FullerTest）和PP檢定（Phillips-PerronTest）。我們這裡介紹ADF
（AugmentedDickey-Fuller）檢定來確認序列是否有單根，ADF檢定的模型為：

其中對應截距，ß對應趨勢，△），+…+△一p被稱為ADF檢定的增廣
項（Augmented），増廣項的期數P可用AIC或BIC來決定。ADF的虛無假
設為序列有單根（非定態）0：=0，對立假設為序列是定態的1：∕<0。該
檢定對應的統計量為：

DF=
SE（i）

其中SE是標準誤（standardError）。該統計量的實際取樣分佈不是/分佈，其極
限分佈也不是標準常態分佈。如果該統計量比臨界值（criticalvalue）來的亅
丷丶，目刂
拒絕虛無假設，也就是說序列是定態的，否則認為該序列是非定態的。

在Python中，我們可以使用arch套件中的ADF函數來進行ADF單根檢定，該函
數具體用法為：

1.ADF（），lags，trend，max_lags，method）

其中，

y是要進行單根檢定的序列；

，t「end用來控制檢定模型類別："”。"表示模型不含截距項，即=0；"。"表示
帶有截距項，即0；則表示包含截距項及線性的趨勢項；"。“"則是在
"ct"的基礎上加入了二次趨勢項；

示一階差分△的落後階數，1。=1表示包含至“，項；如果該項參
的值為None，python會使用method參數所指定的方法選取落後階數；

，””丶g，使用“th。d參數所指定的方法選取落後階數時所選取的階數上
3

，method選取階數時所用的方法，包括'laic"、
"bic"及"tstat"這三種

我們在使用ADF（）函數之前再來回顧一下ADF檢定的虛無假設：序列有單根
（序列是非定態的）。現在，我們對加權股價指數的收益率指數進行單根檢定。



加懽股價指數ADF檢定的模型是：

由於我們的統計量為一8.505小於1%顯著性水平下的臨界值一3.44，所以我們要
拒絕序列非定態的虛無假設，從而判斷出加權股價指數的收益率序列是定態的。

我們也可以對加權股價指數收盤指數序列進行ADF檢定：

檢定結果察看，TestStatistic是-L565，大於criticalvalues給出的1%、5%
10%顯著性水平下的臨界值，因此無法拒絕虛無假設，也就是說加權股價指數收
盤指數序列是非定態的。

24.41白雜訊

金融領域傳統理論的基石，市場有效性假說認為，在弱式有效市場中資產收益率序
列）不存在自相關性。現在我們用討論式的反證法來說明這一結論：假設收益
率存在穩定的相關性，投資者就可以根據歷史資訊估計出相關性的大小、進而預測
未來收益率，然後利用這些資訊進行套利。如果投資者是理性的，都會發現這一機
會，那麼都會進行套利行為，市場的價格發現機制就會改變資產的「未來」價格、
也就是會改變資產「未來」收益率，進而消除掉原本有的相關性。舉個例子，假設
資產A的收益率序列存在自相關性，投資者根據歷史資訊預測出明天該資產的期
望收益率是2%，決定買入資產A，當有很多人都要買入資產A時，它的f賈就
會水漲船高地上漲，進而降低收益率，消除原本存在的自相關性。因此、正常況
下，資產收益率序列不存在自相關性，這個結論可以用來檢定市場是否弜式仃
在釒融領域，不論是建構理論模型還是實際操作應用，不存在自相關性的序列
非常重要的序列，例如白雜訊序列（WhiteNoise）。

24白雜訊過程

妲果一個隨機過程中任意時點t的變數X，，的均值和變異數、自變異數分別滿足以
下式子：

x丶）=0，
Var（xt）-c
2
I>0

則稱這個隨機過程為白雜訊過程。從上述表示式也可以看出，白雜訊過程中各期變
數之間的自變異數為0，也就是說白雜訊過程是沒有相關性的。這種時間序列也可
以稱為純隨機序列（pureRandomSequence）。白雜訊序列一定是定態的時間序
列，白雜訊序列的均值為常數、變異數為常數；其間隔大於0的自變異數都恆等
於0，這滿足定態性序列的自變異數只與時間間隔相關，而不與時間的起始點相關
的要求。不過白雜訊過程只是要求各期變數之間無相關性，但是無相關性不代表各
期之間相互獨立。

如果白雜訊過程中各變數獨立同分佈，且都服從常態分佈，即
Ⅳ（0

則該序列被稱為高斯白雜訊過程（GussianWhiteNoise）。根據定義，可以判斷出
高斯白雜訊過程是嚴定態的時間序列，而且各期之問不止不相關，還互相獨立，也
就是誢如果一個序列是高斯白雜訊過程，則我們無法根據過去資訊推測未來。前文
介紹單桹檢定時，曾經舉了一個非定態時間序列的例子：

其中=0，—N（）0），這裡的隨機擾動項即是服從常態分佈的純隨
機序列，可以改寫成一6，，是/期純隨機變數的加總，所以被稱為隨漫
步（Randomwalk）過程。弱式有效市場假說認為，股票的價格是隨機漫步的，因
此是無法被預測的。

在python裡面，我們可以用numpy包中的standard-normal函數產生一個純隨機
序列，並將該序列畫出來。

第一行程式碼表示產生一組均值為0，變異數為1的常態分佈隨機序列.該序
列中一共有500個（隨機）數。

第二程式碼表示畫出該序列的線圖。
圓24.8，白雜訊

，第二行程式碼產生的圖形。純隨機序列（或白雜訊序列）在時間序列分
g24.8
強的理論意義

2442白雜訊檢定一一Lj“g-B。丶檢定

如果一個序列是純隨機的，那麼它每一次新的變化都無跡可尋，我們無法從中挖掘
出對預測有益的資訊。一旦我們發現某個序列是純隨機序列，說明這個序列已經沒
有什麼可以挖掘的有用資訊，因而可以停止對它分析。既然純隨機序列這麼重要，
那麼我們如何檢定一個序列是否為純隨機或近似純隨機的？

通常我們用Ljung-Box檢定，簡稱LB檢定。簡單來說LB檢定的虛無假設為所檢
定序列是純隨機序列（白雜訊過程），該檢定的統計量為Q統計量：

Q…（丶2一

其中，P，是序列的k階自相關係數，"是整個序列中觀測值的個數，"，是設定的
落後階數。根據Q（m）的計算式可知Q（"）均為正、大小與序列的自相關係數成
正向關係，當序列有自相關性時，其自相關係數較大、對應的Q（"1）也較大；相
反，當序列為隨機序列、無自相關性時，序列的自相關係數不會顯著地異於0，計
算出來的Q（m）也會很小。

"個Q計都小、應00分佈00、界值"、、」十、0、、、、
定旳過程。假設某序列樣本容量"=、00，各階自相關係數、=
去，得到：

100×102×（P，）/99=3.1
100∕102∕〔（（I）-/99+（（2）/98
10罓02∕（（I）2/99+（（2）/98+（P3）/97
=83

在5%的顯著性水平下，的各階臨界值分別為
=3.841Q（1），=5.991，Q（2），=7.815，Q（3），=9.488Q（4）。因
此，在5%的顯著性水平下，該序列沒有一階自相關，很有可能有二階及三階自相
關，四階以上的自相關性不顯著。因此，該序列不是白雜訊序列。

LB檢定過程在python中可以使用statsmodels套件中的q—stat（）函數實作，該函
數的形式為：

1.q—stat（），nobS'type：'Ijungbox'）

x為所檢定的自相關係數序列；

nobs表示計算自相關係數序列x所用的樣本數，即公式中的.

丶pe選取所用的檢定類別；該函數會傳回兩個array物件，分別是檢定的統計
量與P值。一般來說，我們只需要關注p值就好。需要注意的是，該函數會對
每一階進行LB檢定。也就是說，當我們匯入前3階的自相關係數時，該函數
會先對1階的自相關係數進行LB檢定，然後對1階和2階自相關係數進行LB
檢定，最後對所有共3階的自相關係數進行LB檢定。因此，當我們想要對前
三階的自相關係數進行LB檢定時，只需要匯入前三階的自相關係數，然檢
視得到的P值序列中的最後一個值。

24.4.3加權股價指數的白雜訊檢定

LB檢定的虛無假設為所檢定序列是純隨機序列，當LB檢定統計量對應的P值大
於所設定的顯著陸水平（例如5%）時，接受虛無假設，認為所檢定序列為白雜訊
序列。反之則拒絕虛無假設，認為序列是非白雜訊序列。由結果可知：對加權股價
指數收益率序列進行LB檢定時，Q統計量的p值為0.077>0.05，從而要接受
虛無假設，也就是說在某種程度上加權股價指數收益率序列是隨機的。而對加權股
價指數收盤指數序列進行LB檢定時，Q統計量對應的ㄗ值很小，小於顯著性水
平5%，故該序列是存在自相關性的。
