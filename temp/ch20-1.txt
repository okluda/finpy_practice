ru
丿”7/
3
-n
圖20.5：資產組合累積收益率（Ma「ko、it∕模型與隨機配比）
從結果（圖5）可以看出，用Ma「kowitz模型解出的最優資產配置在累積收益
率上，並沒有明顯的優勢。
20.4丨Black-Litterman模型
前文中我們提到投資人做資產配置的前提是對未來形成預期（也就是已知未來各資
產RI，R”…，，的概率分佈），然後利用Ma「kowitz模型求得最優資產配比。
Ma「k丶it∕模型輸入參數的佸計包括歷史資料法和情景分析法兩種方法。情景分析
法的缺點是主觀因素、隨意性太強，因此在實務上，絕大多數人是用各資產的歷史
收益率資料來交替未來的預期收益率資料。整個資產配置過程基本上與上一節中
python實作的流程類似：先獲取各資產的歷史收益率，根據歷史資料得到各
的收益率均值和變異數共變異數矩陣，作為Ma「kowitz模型的輸入變數，最
出最優資產配置比。
整個過程仔細琢磨起來揮發現其有不足之處：基於歷史資料進行計算的基礎是
覀可能
們相信未來各資產的收益率分佈與過去相同，但是現實中過去收益率高的股
由於突事件面臨破產、債券收益率可能會由於央行對利息的調控而發生喞乚
言之，歷史並不一定完全重演。
芬投資組台研究時發現，當對德國債券預期報酬率做0小修後，該
產的投資比例竟然由原來的0提高至：：、這個發說明丶丶0
得到的最優資產配比較輸入參數過於敏感。
上敘述可以看出，根據歷史資訊進行現在的資產配置，並期待未來的投資收
到某個水乎，這整個過程有需要改善之處Black和Litterman提出了改進的
Black-Litterman模型（簡稱BL模型）的核心思想是，將投資者對大類資產的觀
主觀觀點）與市場均衡收益（先驗預期收益率）相結合，從而形成新的預期收
（驗預期收益率）。如果投資者沒有特別的觀點，則依舊使用先驗收益，如
資者對某些資產有特別的觀點，則根據主觀觀點的信賴區間來調整後驗收益，
從而影響投資組合配置。Black-Litterman模型自提出以來，逐漸被華爾街主流所
接受，成為高盛企業資產管理部門在資產配置上的一個主要工具
現在我們簡要介紹下BL模型的求解過程。現在有Ⅳ種資產，其收益率
R=伺述”..，RN），BL模型中假設服從聯合常態分佈，即R~Ⅳ（//，，
蚛和為各資產預期收益率的期望值和共變異數的估計值。現在假設估計向
本身也是隨機的，並且服從常態分佈：
為先驗預期收益率之期望值，「在後文中會詳細解釋BL模型中比較特色
分，是允許考慮投資者個人的觀點（Il”。，”Ⅵ。、”），處理的方式是用各資
率之線性方程組來代表主觀觀點，比如一條觀點可以用以下式子表達：
PliAl+2+…+Ⅳ=，+€1
，受投資人對此條觀點的信賴區
這條觀點的誤差項，q—N（0，Ü2）
（0d。、Level）影響。投資者母體觀點可以用：
0001第、章投資組合理論及其應用
來表達，其中
p（被稱為M丶i丶」）為K丶Ⅳ矩陣，即對Ⅳ個資產有K個觀點.
q為看法向量（K丶1列向量），
Q為看法向量q的誤差項的共變異數矩陣，表示投資者的觀點與真實情況有
別，Q為K∕K的對角矩陣。不同的文獻對其構造方式不同，常見的方法有四
種：
.與先驗預期收益率之變異數成正比，比如He和（1999）設定：
p（T））pTVi—j
Vi
0
或者
Q-diag（P（E）P
這種方法在很多文獻中都很常見，我們這裡就採用該方法來確定Q。
使用信賴巴門.
口口日
利用因子模型的殘差項的變異數；
，用Idzorek（2005）8的方法來確定信賴區間；
比如現在市場有五種資產A，B，C，D，E，投資人基於自己的經驗及分析，形成以下
判斷：
資產的收益率為15%
資產比資產D的收益率高5%
資產和C比資產的收益率低6%
據此，可以寫出反應投資人主觀觀點矩陣：
」000000「000000「00"、0."000g0bb、00「丶0000、00005）：-32.
20.4~Black-Litte「man模型~
101
01
0
0
一0
1~2
1一2
看法向量
看法向量誤差項的共變異數矩陣：
Q=g
根據貝氏定理，結合先驗資訊與投資者觀點的各資產預期收益率的期望值，。服
從常態分佈：
其中期望值（×1列向量）和共變異數矩陣，為：
其中為比例係數（常數），反應主觀觀點相對於先驗資訊的比重。最後，我
們可以得到結合先驗資訊與投資者觀點的各資產彶驗預期收益率分佈（poste「io「
distribution）為.
中Z為誤差項，Ⅳ（0，。因此最後各資產彶驗預期收益率的期望值和變
數分別為：
390~第20章.投資組合理論及其應用
E（RIq
有了各資產之預期收益分佈，特別是預期收益率之期望值與變異數，我們就可以桹
據最小化風險，或者最大化收益率來求解各資產的配比狀況。整體說來，BL模型
求解過程包括以下幾步：
I.使用歷史資料估計預期收益率的共變異數矩陣，假設根據Ⅳ種資產過去丆期的
收益率資料，則共變異數矩陣為：
512
ⅣⅣ
21
Ⅳ2
式中是根據樣本資料估計出來的資產~與的共變異數，表示式為
=E〔（R，一l）（R”一）〕，其中為資產~的歷史平均收益率，
2.確定市場預期之收益率向量（Ⅳ×1列向量），也就是先驗預期收益之期望
值。我們可以用歷史收益率均值作為先驗預期收益之期望值，即"=。也可
以根據市場現有的價格、市場組合構成反推出市場隱藏式均衡收益率（Implied
EquilibriumReturnVector）來作為先驗預期收益之期望：
ELRml-Rf
其中=
為市場組合單位風險的超額收益，反應了市場的風險
2
趨避的程度（為市場組合之收益率，R∕為無風險收益，為市場組
收益率之變異數）
'0"為市場組合各資產的投資比例，i為估計出來的共
；0」丨00~+、”0「模型~
（CAPM模型在後面章節會提及，在這裡不詳述）。
3.融合投資人的個人觀點，即確定p，q，Q
4.修正驗收益。
：，投資資組合優化：透過“。「“”模型，我們可以獲得後驗收益的期
望值與共變異數矩陣。根據這些資訊，我們可以進行資產配置，例如利用
Markowitz模型進行資產配置
20.4.1Black-Litterman模型之python實作
繼續以前面三支股票（台積電，鴻海和統一）為例，根據BL模型求解過程做以下
三几
疋：
l.計算出歷史收益率之均值p及共變異數矩陣j
2.用歷史收益率均值作為先驗預期收益之期望值，即=.
3.結合投資者個人的觀點（由p、Q、Q代表，其中、Q為已知的輸入變
數，Q要自己計算）
4.根據公式計算出後驗分佈之期望值、共變異數
現在我們自己定義函數blacklitterman（）來計算驗分佈之期望值、共變異數，該
函數的輸入變數有股票的歷史收益率（returns）、反應主觀觀點相對於先驗資訊的
比重（tau）、代表投資人看法的和Q。首先我們以歷史收益率均亻直（“）和
共變異數矩陣（，。）作為先驗預期收益之期望值和共變異數，然後根據前文的
公式計算後驗分佈之期望值和共變異數。
1.
2.
#定義函數
>>>fromscipyimportlinalg
>>>defblacklitterman（retUrnS'taU'p'Q）：
、一mu：returns.mean（）
sigma—returns.COV（）
2
第20章.
5緲
6.
7.
8.
9.
1B.
11.
12.
13.
15.
16.
投資組合理論及其應用
pil：mu
ts=tau*sigma
=np.d0t（np.d0t（P，ts），P.T）+np.eye（Q.shapeEe））
Omega
linalg.inv（np.dot（np.dot（P，ts），P.T）+Omega）
middle
np.expand_dims（pi1，axisze）.T+nP.dOt（nP.d0t（np.dot（ts，p
er
T），middle），
（Q-np.expand—dims（np.d0t（P，pi1.T），axis-1）））
np.dot（ts.dot（P.T）.dot（middle）.
Sigma十
posteriorSigma
dot（p），ts）
returnLer，posteriorSigmaJ
我們延續Markowitz模型的3支股票資產配置例子，在這裡要加上投資者的個人
觀點進行分析。現在假設某股票分析師認為，台積電和鴻海的日均收益率將達到
0.09%；鴻海股票和統一股票的日均收益將比浙能電力高0.03%。我們以此為根據
建構個人觀點。
1.
2.
3.
4.
5.
6.
7.
8.
9.
19.
11.
12.
15.
16.
17.
18.
19.
29.
21.
22.
#構造投資人的個人觀點
#建構資產選取矩陣p
>>>pickl：np.array（tl，l，el）
>>>q1znp.array（Ce.0Ø9））
>>>pick2：np.array（L1，Ø，-1））
>>>q2：np.array（tØ.Ø03））
>>>P：np.array（Lpick1，pick2））
>>>Q：np.array（Lq1，q2J）
array（）t
array（）te.øee9），
#修正後驗收益
>>「e：=blacklitte「、0「（「etData，.1，p，Q）
丶、P一、00…pd.DataF「00（「0i「de丶=「etData.001」「
columns-t'posterior_mean冂）
>>>p_mean
posteriormean
HonHaiPrecision
e.09492
.09776
丁5
e.9ee231
uni-president
>>>P—COV
HonHai
Precision
28.HO「Haip「00i：io「
.e99179
.0919B
TS
29.
9.e99966
39.Uni-president
得到了驗收益的期望值與共變異數矩陣後
TSMC
20.4~Black-Litterman模型~393
Uni-President
.999e66
.999977
.99a214
e.eeølee
e.BØØ228
e.9e9e77
，我們就可以利用Markowitz模型進
行資產的配置，設定目標收益率為0.0006，假設我們只能做多，無法做空
1.
2.
3.
4
5.
6.
7.
8.
9.
>>>target—ret2=e.99e6
resL11
>>>COV
pd.Series（resteJL：，e），index-retData.columns）
>>>avg—rets2
>>>weights2=PfOPt.markowitz—portfolio（covmat2'avg—rets2'target—ret2'
allowshort—False）
>>>weights2
.365913
HonHaiPrecision
TSMC
Uni-President
dtype：f10at64
e.5e2497
e.131689
Ⅱ
習題
l.已知有下表所示的5種不同資產組合的風險和收益率的資訊。哪種資產組合不
是有效的資產組合？
風險
預期收益率
0
0.05
0.12
0.07
0.06
0.07
0.04
0.07
0.06
0.05
資產組合
A
B
C
D
E